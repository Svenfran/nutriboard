<%= render 'shared/dash-sidebar' %>
<div class="col-md-4">
  <% @meals.each do |meal| %>
    <div class="wrapper">
      <div class="meal-box">
        <div class="meal-header">
          <h6><%= meal.name %></h6>
          <div class="meal-category">
            <p><%= meal.category %></p>
          </div>
        </div>
        <div class="food-box">
          <ul class="food-info">
            <% @foods.each do |food| %>
              <% if meal.id == food.meal_id %>
                <li class="toggle-nutrients"><%= food.amount.round%><%= food.unit %> <strong><%= food.name %></strong></li>
                <div class="nutrients">
                  <% @nutrients.each do |nutrient| %>
                    <% if food.id == nutrient.food_id %>
                        <li><%= nutrient.amount.round %><%= nutrient.unit %> <%= nutrient.name %></li>
                    <% end %>
                  <% end %>
                </div>
              <% end %>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>
</div>

<script>
// right now it toggles only the nutrients of the first food showen (each with index??)
const toggleNutrients = document.querySelectorAll('.toggle-nutrients');
const nutrients = document.querySelector('.nutrients');

toggleNutrients.forEach((nutrient) => {
  nutrient.addEventListener('click', () => {
    nutrients.classList.toggle('open')
  });
});
</script>
